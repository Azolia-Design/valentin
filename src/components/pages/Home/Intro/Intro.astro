---
import { Icon } from 'astro-icon/components';
import Image from '~/components/common/Image.astro';
import Arrows from '~/components/common/Arrows.astro';
import TextBlurFading from '~/components/common/TextBlurFading';
import Marquee from '~/components/common/Marquee';
import IntroScript  from './script';
import BreakMultipleLine from '~/components/common/BreakMultipleLine.astro';
import { getImage } from 'astro:assets';
import liquid from '~/icons/company/liquid.svg';
import gotyme from '~/icons/company/gotyme-bank.svg';
import europeanCommission from '~/icons/company/european-commission.svg';
import bitcoin from '~/icons/company/bitcoin.svg';
import defichan from '~/icons/company/defichan.svg';
import bitmex from '~/icons/company/bitmex.svg';
import birthdayResearch from '~/icons/company/birthday-research.svg';
import babylons from '~/icons/company/babylons.svg';
import diag from '~/icons/company/diag.svg';
import RedDot from '~/icons/red-dot.svg?raw';
import UXDesign from '~/icons/uxdesign.svg?raw';
import DFA from '~/icons/dfa.svg?raw';
import Asterisk from '~/icons/asterisk.svg?raw'

const { data } = Astro.props;
const companies = [
    await getImage({ src: liquid, format: 'svg'}),
    await getImage({ src:  gotyme, format: 'svg'}),
    await getImage({ src:  europeanCommission, format: 'svg'}),
    await getImage({ src: bitcoin, format: 'svg'}),
    await getImage({ src: defichan, format: 'svg'}),
    await getImage({ src: bitmex, format: 'svg'}),
    await getImage({ src:  birthdayResearch, format: 'svg'}),
    await getImage({ src: babylons, format: 'svg'}),
    await getImage({ src:diag ,format: 'svg'})
]
const awards = [
    { name: "Red Dot Design award", year: "2022", category: "Bitcoin and Crypto DeFi Wallet", logo: RedDot },
    { name: "UX Design Award", year: "2022", category: "Bitcoin and Crypto DeFi Wallet", logo: UXDesign },
    { name: "Design for Asia award", year: "2022", category: "Bitcoin and Crypto DeFi Wallet", logo: DFA },
    { name: "Creative Pool", year: "2022", category: "Bitcoin and Crypto DeFi Wallet", logo: RedDot },
    { name: "UX Design Award", year: "2022", category: "Bitcoin and Crypto DeFi Wallet", logo: UXDesign }
]
const itemLength = awards.length;

---
<div class="home__intro-wrap">
    <section class="home__intro">
        <IntroScript client:visible={{ rootMargin: "100% 0% 100% 0%" }}/>
        <div class="container grid">
            <div class="home__intro-companies">
                <h4 class="heading h5 cl-txt-title home__intro-companies-title">I've helped <br/>over 100 companies including</h4>
                <div class="home__intro-companies-listing">
                    {companies.map((ic) =>
                        <div
                            class="home__intro-company"
                            data-cursor-stick
                            data-cursor="-hidden"
                            >
                            <div class="ic home__intro-company-ic">
                                <Image
                                    src={ic.src}
                                    widths={[400, 768, 1024, 2040]}
                                    width={148}
                                    alt={'company logo'}
                                    layout="cover"
                                    decoding="sync"
                                    loading="lazy"
                                    class="img img-fill"
                                />
                            </div>
                        </div>
                    )}
                    <div class="home__intro-company">
                    </div>
                </div>
            </div>
            <div class="home__intro-main">
                <div class="home__intro-bg-gradient"></div>
                <div class="heading h4 home__intro-main-txt">
                    <TextBlurFading
                        triggerOpts = {{
                            start: 'top top+=50%',
                            end: 'bottom top+=50%'
                        }}
                        client:visible={{ rootMargin: "100% 0% 100% 0%" }}
                        >
                            <span class="fs-24 home__intro-main-label">(intro)</span>
                            <BreakMultipleLine text={data.title}/>
                    </TextBlurFading>
                </div>
                <a href="#" class="btn btn-circle arrow-hover home__intro-btn" data-cursor="-hidden" data-cursor-stick>
                    <Arrows type="long" size={3.2}/>
                    <svg class="btn-circle-svg" width="100%" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="50" cy="50" r="49" stroke="white" stroke-opacity=".1" stroke-width="2"/>
                    </svg>
                </a>
            </div>
            <div class="home__intro-portrait">
                <Image
                    src={'~/assets/images/intro-portrait.jpg'}
                    width={183}
                    height={244}
                    alt={'a man'}
                    layout="cover"
                    loading="lazy"
                    decoding="async"
                />
                <Image
                    src={'~/assets/images/intro-portrait-blur.png'}
                    widths={[400, 768, 1024]}
                    width={183}
                    height={244}
                    alt={'a orange blur'}
                    layout="cover"
                    loading="lazy"
                    decoding="async"
                />
            </div>
            <div class="home__intro-awards" style={{ '--itemLength': itemLength }}>
                <h3 class="heading h4 cl-txt-title upper home__intro-awards-title">Awards</h3>
                <div class="home__intro-awards-wrap">
                    <div class="home__intro-awards-listing">
                        {awards.map((award) =>
                            <div class="home__intro-award">
                                <span class="line"></span>
                                <div class="home__intro-award-inner">
                                    <p class="fs-24 cl-txt-desc home__intro-award-name">{award.name}</p>
                                    <p class="cl-txt-disable home__intro-award-year">{award.year}</p>
                                    <p class="cl-txt-disable home__intro-award-category">{award.category}</p>
                                </div>
                                <div class="home__intro-award-logo-mb">
                                    <Fragment set:html={award.logo}/>
                                </div>
                            </div>
                            <div class="home__intro-award-logo">
                                <Fragment set:html={award.logo}/>
                            </div>
                        )}
                    </div>
                </div>
            </div>
        </div>
        <div class="home__intro-service-wrap">
            <div class="home__intro-service">
                <div class="home__intro-service-marquee-wrap black">
                    <Marquee start="right" client:visible={{ rootMargin: "100% 0% 100% 0%" }}>
                        <div class="home__intro-service-marquee">
                            <div class="home__intro-service-marquee-item">
                                <h3 class="fw-semi heading h3 upper">
                                    8 years of experience
                                </h3>
                                <div class="ic ic-32">
                                    <Fragment set:html={Asterisk} />
                                </div>
                            </div>
                            <div class="home__intro-service-marquee-item">
                                <h3 class="fw-semi heading h3 upper">
                                    senior designer
                                </h3>
                                <div class="ic ic-32">
                                    <Fragment set:html={Asterisk} />
                                </div>
                            </div>
                            <div class="home__intro-service-marquee-item">
                                <h3 class="fw-semi heading h3 upper">
                                    Over 100 customers
                                </h3>
                                <div class="ic ic-32">
                                    <Fragment set:html={Asterisk} />
                                </div>
                            </div>
                        </div>
                    </Marquee>
                </div>
                <div class="home__intro-service-marquee-wrap orange">
                    <Marquee start="left" client:visible={{ rootMargin: "100% 0% 100% 0%" }}>
                        <div class="home__intro-service-marquee">
                            <div class="home__intro-service-marquee-item">
                                <h3 class="fw-semi heading h3 upper">
                                    Product Design
                                </h3>
                                <div class="ic ic-32">
                                    <Fragment set:html={Asterisk} />
                                </div>
                            </div>
                            <div class="home__intro-service-marquee-item">
                                <h3 class="fw-semi heading h3 upper">
                                    Brand design & Strategy
                                </h3>
                                <div class="ic ic-32">
                                    <Fragment set:html={Asterisk} />
                                </div>
                            </div>
                            <div class="home__intro-service-marquee-item">
                                <h3 class="fw-semi heading h3 upper">
                                    Visual design
                                </h3>
                                <div class="ic ic-32">
                                    <Fragment set:html={Asterisk} />
                                </div>
                            </div>
                        </div>
                    </Marquee>
                </div>
            </div>
            <div class="home__intro-service-blur">
                <div class="home__intro-service-blur-inner">
                    <Image
                        src={'~/assets/images/intro-service-blur.png'}
                        widths={[400, 768, 1024]}
                        width={1511}
                        alt={'a orange blur'}
                        layout="cover"
                        loading="lazy"
                        decoding="async"
                        aspectRatio="1"
                    />
                </div>
            </div>
        </div>
    </section>
</div>

<style lang="scss" is:global>
    @use '~/assets/styles/mixins' as *;
    .home__intro {
        --padding-top: 31rem;

        position: relative;
        z-index: 4;

        // padding-top: var(--padding-top);
        margin-top: calc(-100vh - var(--padding-top));
        > .container {
            // background-color: var(--cl-dm-bg);
        }
        &-main {
            grid-column: 9/-1;

            @include tColor(title, dm);
            @include md {
                grid-column: 6/13;
            }
            @include sm {
                grid-column: 1/-1;
                grid-row: 1/2;
            }
            &-label {
                vertical-align: top;
                margin-right: 13rem;
                @include tColor(body, dm);

                @include md {
                    @include text(16);
                    margin-right: 6rem;
                }
                @include sm {
                    margin-right: 8rem;
                }
            }
            &-txt {
                margin-bottom: 6rem;
                @include md {
                    margin-bottom: 3.2rem;
                }
            }
        }
        &-btn {
            @include size(10rem);
        }
        &-portrait {
            display: grid;
            grid-column: 15/-1;
            margin-top: -2.8rem;
            margin-bottom: 12rem;
            @include md {
                margin-block: 8rem;
                grid-column: 11/13;
            }
            @include sm {
                grid-column: 3/5;
                grid-row: 2/3;
                margin-block: 6rem;
            }
            img {
                grid-area: 1/1/2/2;
            }
        }
        &-companies {
            grid-column: 1/7;
            grid-row: 1/4;

            // align-self: center;
            will-change: transform, opacity;
            @include md {
                grid-column: 1/5;
            }
            @include sm {
                grid-column: 1/-1;
                grid-row: 3/4;
                margin-bottom: 6rem;
            }
            &-title {
                max-width: 29.5rem;

                padding-block: 4rem;
                margin-bottom: 6rem;

                border-top: .1rem solid var(--cl-dm-border);
                @include sm {
                    padding-block: 6rem 4rem;
                    margin-bottom: 0;
                }
            }
            &-listing {
                display: grid;
                grid-template-columns: repeat(4, 1fr);
                @include sm {
                    grid-template-columns: repeat(3, 1fr);
                }
            }
        }
        &-company {
            width: 14.8rem;

            display: flex;
            justify-content: center;
            align-items: center;

            background-color: rgba(255, 255, 255, 0.05);
            transition: background 0.4s ease-in-out;
            backdrop-filter: blur(.5rem);
            &:after {
                content: '';
                height: 0;
                padding-top: 100%;
            }
            @include md {
                width: 10rem;
            }
            @include sm {
                width: auto;
            }
            &-ic {
                width: 10.9rem;
                height: auto;
                position: absolute;
                opacity: .3;
                transition: opacity 0.4s cubic-bezier(.74, .06, .4, .92);
                @include md {
                    width: 7.3rem;
                }
            }

            &:hover {
                background-color: var(--cl-orange);
                .home__intro-company-ic {
                    opacity: 1;
                }
            }
            &:nth-child(2) {
                grid-row: 2/3;
            }
            &:nth-child(3),
            &:nth-child(4) {
                grid-row: 3/4;
            }
            &:nth-child(5),
            &:nth-child(6) {
                grid-row: 4/5;
            }
            &:nth-child(7),
            &:nth-child(8) {
                grid-row: 5/6;
            }
            &:nth-child(9) {
                grid-row: 6/7;
            }
            &:nth-child(2),
            &:nth-child(5),
            &:nth-child(9) {
                grid-column: 2/3;
            }
            &:nth-child(7),
            &:nth-child(10) {
                grid-column: 1/2;
            }
            &:nth-child(4),
            &:nth-child(8) {
                grid-column: 3/4;
            }
            &:nth-child(6) {
                grid-column: 4/5;
                @include md {
                    grid-column: 3/4;
                    grid-row: 7/8;
                }
            }
            &:nth-child(10) {
                grid-column: 1/3;
            }

            @include sm {
                &:nth-child(3n) {
                    grid-column: 2/3;
                }
                &:nth-child(3n - 1) {
                    grid-column: 3/4;
                }
                &:nth-child(3n - 2) {
                    grid-column: 1/2;
                }
                &:nth-child(2) {
                    grid-row: 1/2;
                }
                &:nth-child(3) {
                    grid-row: 2/3;
                }
                &:nth-child(5) {
                    grid-row: 3/4;
                }
                &:nth-child(6) {
                    grid-row: 4/5;
                }
                &:nth-child(9) {
                    grid-row: 7/8;
                }
                &:last-child {
                    display: none;
                }
            }
        }
        &-awards {
            --scale-factor: 3;
            --height-item: 7.12rem;

            position: relative;
            grid-column: 9/-1;
            padding-bottom: 16rem;
            @include md {
                --height-item: 11.8rem;
                --scale-factor: 2.5;

                grid-column: 6/-1;
                padding-bottom: 12rem;
            }
            @include sm {
                grid-column: 1/-1;
                padding-top: 6rem;
            }
            &-wrap {
                margin-bottom: calc((var(--height-item) * -1) * (var(--scale-factor) - 1) * var(--itemLength));
            }
            &-title {
                margin-bottom: 6rem;
                @include md {
                    margin-bottom: 4rem;
                }
                @include sm {
                    @include text(h3);
                }
            }
            &-listing {
                // position: relative;
                height: calc(var(--height-item) * var(--scale-factor) * var(--itemLength));
            }
        }
        &-award {
            padding-block: 2rem;
            border-top: 1px solid var(--cl-dm-border);

            position: relative;
            height: calc(var(--height-item) * var(--scale-factor));
            display: flex;
            align-items: center;
            @include md {
                display: flex;
                align-items: center;
                justify-content: space-between;
            }
            &-inner {
                display: grid;
                column-gap: 2rem;
                grid-template-columns: 51.32fr 10.49fr 38.19fr;
                align-items: center;
                @include md {
                    display: flex;
                    flex-direction: column;
                    align-items: flex-start;
                    gap: 0;
                }
            }
            &-name {
                transition: color 1.333s cubic-bezier(.74, .06, .4, .92);
                @include md {
                    @include text(h5);
                    @include tColor(title, dm);
                    margin-bottom: 1rem;
                }
                @include sm {
                    margin-bottom: .6rem;
                }
            }
            &-year {
                transition: color 1.333s cubic-bezier(.74, .06, .4, .92);
                @include md {
                    order: -1;
                }
            }
            &-category {
                justify-self: end;
                transition: color 1.333s cubic-bezier(.74, .06, .4, .92);
            }

            &-logo {
                position: absolute;
                top: 50%;
                left: -12rem;

                color: var(--cl-orange);
                @include size(12rem);

                opacity: 0;
                transform: translate(-100%, -50%) scale(1.1);
                will-change: transform, opacity;

                transition: opacity 0.4s ease-in-out, transform .4s ease-in-out;
                @include md {
                    display: none;
                }
                &-mb {
                    display: none;
                    @include md {
                        display: block;
                        color: var(--cl-orange);
                        @include size(5rem);
                    }
                }
            }

            .line {
                position: absolute;
                top: 0;
                left: 0;
                @include size(100%, .1rem);
                overflow: hidden;

                &:before,
                &:after {
                    --line-spacing: 1rem;

                    content: '';
                    position: absolute;
                    display: block;
                    inset: auto 0 0;
                    @include size(100%);
                    transition: transform .65s cubic-bezier(.6, 0, .3, 1) .15s;

                    @include sm {
                        height: 1px;
                    }
                }

                &:before {
                    opacity: 0;
                    left: 0;
                    background: #C4C4C4;
                    transition: transform .65s cubic-bezier(.6, 0, .3, 1), opacity .65s cubic-bezier(.6, 0, .3, 1) .05s;
                }

                &:after {
                    left: calc(-1 * var(--line-spacing));
                    opacity: .8;
                    transform: translateX(-100%);
                    background: #C4C4C4;
                    transition: transform .65s cubic-bezier(.6, 0, .3, 1) .2s;
                }
            }

            &:hover {
                .home__intro-award-name {
                    @include tColor(title, dm);
                }
                .home__intro-award-year {
                    @include tColor(desc, dm);
                }
                .home__intro-award-category {
                    @include tColor(body, dm);
                }
                + .home__intro-award-logo {
                    opacity: 1;
                    transform: translate(-100%, -50%) scale(1);
                }
                .line {
                    &:before {
                        opacity: 1;
                        transform: translateX(calc(100% + var(--line-spacing))) rotate(.01deg);
                    }

                    &:after {
                        transform: translateX(var(--line-spacing)) rotate(.01deg)
                    }
                }
            }
        }
        &-service {
            background-color: var(--cl-dm-bg);
            height: 53.5rem;
            display: grid;
            grid-template-columns: 1fr;
            align-items: center;
            justify-content: center;
            contain: paint;
            position: relative;
            z-index: 4;
            &-wrap {
                position: relative;
                z-index: 3;
                @include sm {
                    overflow: hidden;
                    z-index: 1;
                    margin-block: -12rem -4rem;
                }
            }
            &-marquee {
                display: flex;
                align-items: center;
                gap: 0 4rem;

                padding: 2.3rem 2rem;
                @include sm {
                    gap: 0 1.5rem;
                    padding: 1.4rem 1rem;
                }
                &-wrap {
                    transition: all .4s cubic-bezier(.74, .06, .4, .92);
                    grid-area: 1/1/2/2;
                    display: flex;
                    position: relative;
                    margin: 0 calc(var(--container-padding) * -1);
                    &.orange {
                        @include tColor(title, dm);
                        background-color: var(--cl-orange);
                        transform: rotate(9.139deg);
                        transform-origin: center;
                        z-index: 3;
                        box-shadow: 0px 0px 2rem 0px rgba(255, 61, 0, 0.55);
                        &:hover {
                            .home__intro-service-marquee-wrap.black {
                                filter: blur(.7rem);
                            }
                        }
                    }
                    &.black {
                        background-color: black;
                        @include tColor(desc, dm);

                        transform: rotate(-5.831deg);
                        transform-origin: center;
                        filter: blur(.7rem);
                        z-index: 2;
                        box-shadow: 0px 0px 2rem 0px rgba(0, 0, 0, 0.55);
                        &:hover {
                            filter: blur(0);
                            @include tColor(title, dm);
                            ~ .home__intro-service-marquee-wrap {
                                filter: blur(.7rem);
                            }
                        }
                    }
                }
                &-item {
                    display: flex;
                    align-items: center;
                    gap: 0 4rem;
                    @include sm {
                        gap: 0 1.5rem;
                    }
                    h3 {
                        @include sm {
                            @include text(h4);
                            font-family: 'Matter SQ Med', sans-serif;
                            font-weight: 500;
                        }
                    }
                    .ic-32 {
                        @include sm {
                            @include size(1.2rem);
                        }
                    }
                }
            }
            &-blur {
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                z-index: 4;
                pointer-events: none;
                height: 151.1rem;
                width: 100%;

                display: flex;
                justify-content: center;
                align-items: center;
                @include sm {
                    height: 80rem;
                }
                &-inner {
                    @include size(151.1rem);
                    @include sm {
                        @include size(80rem);
                    }
                }
            }
        }
        &-bg-gradient {
            position: absolute;
            // background-image: linear-gradient(to top, rgb(0, 5, 15), rgba(0, 5, 15, 0));
            height: 100%;
            width: 100%;
            @include size(100%);
            z-index: -1;
            left: 0;
            pointer-events: none;

            background: linear-gradient(
                rgba(0, 5, 15, 0),
                rgba(0, 5, 15, 0.5) 10%,
                rgba(0, 5, 15, 0.8) 20%,
                rgba(0, 5, 15, 1) 60%,
                rgb(0, 5, 15)
            );

            // backdrop-filter: blur(6.7rem);
            // -webkit-backdrop-filter: blur(6.7rem);


            // mask-image: linear-gradient(
            //     rgba(0, 5, 15, 0),
            //     rgba(0, 5, 15, 0.5) 10%,
            //     rgba(0, 5, 15, 0.8) 20%,
            //     rgba(0, 5, 15, 1) 40%,
            //     rgb(0, 5, 15)
            // );

            // -webkit-mask-image: linear-gradient(
            //     rgba(0, 5, 15, 0),
            //     rgba(0, 5, 15, 0.5) 10%,
            //     rgba(0, 5, 15, 0.8) 20%,
            //     rgba(0, 5, 15, 1) 40%,
            //     rgb(0, 5, 15)
            // );
        }
    }
</style>
