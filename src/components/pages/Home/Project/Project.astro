---
import TextTransClip from '~/components/common/TextTransClip';
import ProjectListing from './ProjectListing';
import Arrows from "~/components/common/Arrows.astro";
import Image from "~/components/common/Image.astro";

let currentYear = new Date().getFullYear() % 100;

const projects = [
    {
        link: "#",
        year: 2018,
        title: "X21 Digital Leads $3 Million Seed Funding Round",
        role: ["Design system", "Mobile app design", "Graphic Design"],
        desc: "Lorem ipsum dolor sit amet consectetur. Sit non risus sed in mauris amet. Venenatis interdum pellentesque pellentesque.",
        thumbnail: {
            src: "src/assets/images/intro-portrait.jpg",
            alt: 'mockup iphone'
        }
    },
    {
        link: "#",
        year: 2019,
        title: "DeFi Sells Out Seed Round Allocation",
        role: ["Website maintenance", "AI Design"],
        desc: "Lorem ipsum dolor sit amet consectetur. Sit non risus sed in mauris amet. Venenatis interdum pellentesque pellentesque.",
        thumbnail: {
            src: "/images/project-thumb.jpg",
            alt: 'mockup iphone'
        }
    },
    {
        link: "#",
        year: 2020,
        title: "Bitcoin and Crypto DeFi Wallet",
        role: ["Brand Identity", "Product Design", "SEO", "Art Direction"],
        desc: "Lorem ipsum dolor sit amet consectetur. Sit non risus sed in mauris amet. Venenatis interdum pellentesque pellentesque.",
        thumbnail: {
            src: "src/assets/images/intro-portrait.jpg",
            alt: 'mockup iphone'
        }
    },
    {
        link: "#",
        year: 2021,
        title: "Unlocking Interoperability Without Wrapped Tokens",
        role: ["Web-app design", "Website Design", "Art Direction"],
        desc: "Lorem ipsum dolor sit amet consectetur. Sit non risus sed in mauris amet. Venenatis interdum pellentesque pellentesque.",
        thumbnail: {
            src: "/images/project-thumb.jpg",
            alt: 'mockup iphone'
        }
    }
]
---
<div class="home__project-wrap">
    <section class="home__project">
        <div class="container">
            <h2 class="upper home__project-title grid">
                <span class="heading h2 fw-bold home__project-title-txt">
                    <TextTransClip
                        triggerOpts = {{
                            trigger: '.home__project-title',
                        }}
                        client:visible={{ rootMargin: "100% 0% 100% 0%" }}>Projects I</TextTransClip>
                </span>
                <span class="heading h2 fw-bold home__project-title-txt">
                    <TextTransClip
                        triggerOpts = {{
                            trigger: '.home__project-title',
                            end: 'bottom top+=46%',
                        }}
                        client:visible={{ rootMargin: "100% 0% 100% 0%" }}>worked on</TextTransClip>
                </span>
                <span class="heading h2 fw-bold cl-txt-disable home__project-title-txt">
                    <TextTransClip
                        triggerOpts = {{
                            trigger: '.home__project-title',
                            end: 'bottom top+=42%',
                        }}
                        client:visible={{ rootMargin: "100% 0% 100% 0%" }}>16-{currentYear}<span class="heading h3 fw-semi ver-align-top cl-txt-orange"> Â®</span></TextTransClip>
                </span>
                <span class="fs-20 cl-txt-desc fw-reg upper home__project-title-label">(Portfolio)</span>
            </h2>
            <div class="home__project-main">
                <ProjectListing data={projects} client:visible={{ rootMargin: "100% 0% 100% 0%" }}>
                    <Image
                        src={'~/assets/images/project-blur-thumb.png'}
                        widths={[400, 768, 1024]}
                        width={692}
                        height={903}
                        alt={'orange blur'}
                        layout="cover"
                        loading="lazy"
                        decoding="async"
                        slot="blur"
                        class="home__project-thumbnail-blur"
                    />
                    <Arrows slot="arrows" />
                </ProjectListing>
            </div>
        </div>
    </section>
</div>
<style lang="scss" is:global>
    @use '~/assets/styles/mixins' as *;

    .home__project {
        padding-block: 16rem;
        &-title {

            margin-bottom: 16rem;
            position: relative;
            // gap: 1rem 0;
            &-label {
                grid-column: 14/16;
                grid-row: 1/2;
                justify-self: end;
            }
            &-txt {
                line-height: .835em;
                &:nth-child(1) {
                    grid-column: 1/16;
                    grid-row: 1/2;
                    margin-left: 1.8rem;
                }
                &:nth-child(2) {
                    grid-column: 5/16;
                }
                &:nth-child(3) {
                    grid-column: 5/16;
                }
            }
        }
        &-main {
            height: 100vh;
        }
        &-listing {
            padding-bottom: 4.5rem;
            height: 100%;
            padding: 7vh 0;
        }
        &-name {
            grid-column: 1/4;
            grid-row: 2/3;
            align-self: end;
            &-txt {
                display: -webkit-box;
                -webkit-box-orient: vertical;
                text-overflow: ellipsis;
                overflow: hidden;
                -webkit-line-clamp: 3;
            }
        }
        &-pagination {
            padding-block: 2rem;
            margin-bottom: 4rem;

            border-bottom: .1rem solid var(--cl-dm-border);
        }
        &-slide {
            display: flex;
            flex-direction: column;
            margin: -1rem 0;
            &-item {
                position: relative;
                @include size(100%);

                display: flex;
                justify-content: center;
                align-items: center;
                &-wrap {
                    height: .2rem;
                    overflow: hidden;

                    transition: height 1s cubic-bezier(0.16, 1, 0.3, 1) .5s;
                    padding: 1rem 0;
                    cursor: pointer;
                    &.active {
                        height: 11.4rem;
                        // transition-delay: 0s;
                        .home__project-slide-item-progress {
                            opacity: 1;
                            transition: opacity 1s cubic-bezier(0.16, 1, 0.3, 1) .1s;
                        }
                        .home__project-slide-item-progress-inner {
                            opacity: 1;
                            transition: opacity 1s cubic-bezier(0.16, 1, 0.3, 1) .24s;
                        }
                        .home__project-slide-item-img {
                            clip-path: polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%);
                            transition-delay: 0s;

                            img {
                                opacity: 1;
                                transform: scale(1);
                                transition-delay: .1s;
                            }
                        }
                    }
                }
                &-img {
                    position: absolute;
                    z-index: 3;
                    width: 80.48%;
                    height: 85.45%;
                    overflow: hidden;
                    clip-path: polygon(50% 50%, 50% 50%, 50% 50%, 50% 50%);
                    transition: clip-path 1s cubic-bezier(0.16, 1, 0.3, 1) .4s;
                    img {
                        opacity: 0;
                        transform: scale(1.4);
                        transition: transform 1.5s cubic-bezier(0.33, 1, 0.68, 1) .2s, opacity 1s cubic-bezier(0.16, 1, 0.3, 1) .2s;
                    }
                }
                &-progress {
                    z-index: 2;
                    position: absolute;
                    inset: 0;
                    border: .2rem solid transparent;
                    background: #fff border-box;
                    -webkit-mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
                    mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
                    mask-composite: exclude;
                    opacity: .1;
                    transition: opacity 1s cubic-bezier(0.16, 1, 0.3, 1) .3s;
                    &-inner {
                        position: absolute;
                        z-index: 3;
                        // inset: -.15rem;
                        // border: .2rem solid transparent;
                        @include size(150%);
                        // top: 50%;
                        // left: 50%;
                        // transform: translate(-50%, -50%);
                        background: linear-gradient(45deg, rgba(255, 61, 0, 0), rgba(255, 61, 0, 1)) border-box;
                        // -webkit-mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
                        // mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
                        // mask-composite: exclude;
                        // opacity: 0;
                        // transition: opacity 1s cubic-bezier(0.16, 1, 0.3, 1) .3s;
                    }
                }
            }
        }
        &-thumbnail {
            grid-column: 5/12;
            grid-row: 1/3;
            height: 100%;

            position: relative;
            overflow: hidden;
            >  * {
                height: 100%;
            }
            &-img {
                pointer-events: none;
                flex: none;
                position: relative;
                @include size(100%);

                display: flex;
                justify-content: center;
                align-items: center;
                position: relative;

                img {
                    object-fit: cover;
                    position: absolute;
                }
            }
            &-blur {
                position: absolute;
                bottom: 0;
                right: 0;
                z-index: 2;
                pointer-events: none;
            }
        }
        &-sub-info {
            grid-column: 13/16;
        }
        &-desc {
            grid-column: 13/17;
            align-self: end;
        }
        &-link {
            display: flex;
            align-items: center;
            column-gap: .6rem;

            margin-top: 14vh;
            margin-bottom: 2.4vh;
        }
        &-role {
            &-listing {
                display: flex;
                flex-direction: column;
                row-gap: 1.2rem;
            }
        }
        &-year {
            margin-bottom: 9.5vh;
        }
        &-label {
            margin-bottom: 1rem;
        }
    }
</style>